(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3002],{9698:function(e,i,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/edit/[id]",function(){return l(75766)}])},16278:function(e,i,l){"use strict";var t=l(85893);l(67294);var n=l(13029),r=l(46901);i.Z=e=>{let{open:i,onClose:l,message:s}=e;return(0,t.jsx)(n.Z,{open:i,autoHideDuration:6e3,onClose:l,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,t.jsx)(r.Z,{onClose:l,severity:"success",sx:{width:"100%"},children:s})})}},70515:function(e,i,l){"use strict";var t=l(85893);l(67294);var n=l(13029),r=l(46901);i.Z=e=>{let{open:i,onClose:l,message:s}=e;return(0,t.jsx)(n.Z,{open:i,autoHideDuration:6e3,onClose:l,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,t.jsx)(r.Z,{onClose:l,variant:"filled",severity:"error",sx:{width:"100%"},children:s})})}},75766:function(e,i,l){"use strict";l.r(i);var t=l(85893),n=l(67294),r=l(9008),s=l.n(r),o=l(41664),a=l.n(o),d=l(36822),u=l(21214),c=l(16216),x=l(15861),h=l(66242),p=l(86886),m=l(50135),v=l(83978),j=l(31812),g=l(16310),f=l(28482),y=l(90948),Z=l(11791),b=l(39620),S=l(30015),_=l(7328),E=l(2664),R=l(26903),z=l(35110),P=l(16278),T=l(70515),w=l(11163),D=l(9424),A=l(40294),F=l(35191),C=l(65400),N=l.n(C),U=l(28465);(0,y.ZP)(Z.Z)(e=>{let{theme:i}=e;return{backgroundColor:"dark"===i.palette.mode?"#1A2027":"#fff",...i.typography.body2,padding:i.spacing(1),textAlign:"center",color:i.palette.text.secondary}});let O=e=>{let i=(0,w.useRouter)(),{id:l}=i.query,[r,o]=(0,n.useState)(),[y,Z]=(0,n.useState)(),[b,S]=(0,n.useState)({id:0,name:"Select"}),[_,E]=(0,n.useState)([]),[R,C]=(0,n.useState)(!0),[O,L]=(0,n.useState)(null),[k,I]=(0,n.useState)(""),[G,H]=(0,n.useState)(null),[M,W]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=async()=>{try{var e,i,t;let n=await (0,z.AH)(l);E(null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.user),H(null==n?void 0:null===(t=n.data)||void 0===t?void 0:null===(i=t.user)||void 0===i?void 0:i.photo),C(!1)}catch(e){console.log(e)}};e()},[]),(0,n.useEffect)(()=>{(0,z._D)().then(e=>{var i;(null==e?void 0:e.code)==200&&S(null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.organizations)})},[]);let Q=(e,i)=>{if(e.fileList.length>0){let l=e.fileList[0].originFileObj;console.log("file:",l);let t=new FileReader;t.onload=()=>{console.log("reader.result:",t.result),H(t.result),I(t.result),i("photo",t.result)},t.readAsDataURL(l)}},q=g.Ry().shape({name:g.Z_().required(D.xR.REQUIRED.NAME),email:g.Z_().required(D.xR.REQUIRED.EMAIL),mobile:g.Z_().matches(/^01[0-9]{9}$/,"Invalid phone number").required(D.xR.REQUIRED.PHONE)}),[V,B]=(0,n.useState)(!1),[X,$]=(0,n.useState)(!1),[J,K]=(0,n.useState)(""),Y=()=>{K(""),B(!1),$(!1)},ee=[{value:1,label:"Active"},{value:0,label:"Inactive"}],ei=[{id:2,name:"System Admin"},{id:3,name:"Organization Admin"}],el=ei.filter(e=>e.id==(null==_?void 0:_.user_type));(0,n.useEffect)(()=>{o(el[0])},[_]),(0,n.useEffect)(()=>{if(b.length>0){let e=b.filter(e=>{var i;return e.id==(null==_?void 0:null===(i=_.organization)||void 0===i?void 0:i.id)});Z(e[0])}},[_,b]),console.log(y,"users");let[et,en]=(0,n.useState)([]),[er,es]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=async()=>{en(ee),es({value:1,label:"Active"})};e()},[_]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s(),{children:(0,t.jsx)("title",{children:D.xR.UPDATE_USER_TITLE})}),!1===R&&void 0!==r&&void 0!==y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{component:"main",sx:{flexGrow:1},children:(0,t.jsx)(u.Z,{maxWidth:"xl",children:(0,t.jsx)(c.Z,{spacing:3,children:(0,t.jsx)(c.Z,{direction:"row",justifyContent:"space-between",spacing:4,children:(0,t.jsx)(c.Z,{spacing:1,children:(0,t.jsx)(x.Z,{variant:"h5",sx:{padding:"8px",marginLeft:""},children:D.xR.UPDATE_USER_TITLE})})})})})}),(0,t.jsx)(d.Z,{component:"main",sx:{flexGrow:1,py:1},children:(0,t.jsx)(u.Z,{maxWidth:"xl",children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(d.Z,{sx:{flexGrow:1,width:"90%",margin:"0 auto",marginTop:"2rem"},children:(0,t.jsx)(p.ZP,{container:!0,spacing:2,children:(0,t.jsx)(p.ZP,{item:!0,xs:12,children:(0,t.jsx)(f.J9,{initialValues:{id:l,name:(null==_?void 0:_.name)||"",email:(null==_?void 0:_.email)||"",mobile:(null==_?void 0:_.mobile)||"",photo:(null==_?void 0:_.photo)||k,status:(null==_?void 0:_.status)||"",user_type:(null==_?void 0:_.user_type)||"",organization_id:(null==_?void 0:_.organization_id)||""},onSubmit:e=>{if(W(!0),setTimeout(()=>{W(!1)},1e3),O){let e=new FileReader;e.readAsDataURL(O),e.onloadend=()=>{I(e.result)}}for(let i in e)e.hasOwnProperty(i)&&""===e[i]&&delete e[i],"photo"===i&&e[i].startsWith("http")&&delete e[i];console.log(e),(0,z.GR)(e).then(e=>{if(200===e.code)K(D.xR.UPDATE_SUCCESS_MESSAGE),B(!0),setTimeout(()=>{i.push(A.GN.USER_REQUEST)},3e3);else{var l;if(Object.keys(null==e?void 0:e.errors).length>0){for(let i in null===(l=e)||void 0===l?void 0:l.errors)if(e.errors[i]){let l=e.errors[i];for(let e=0;e<l.length;e++){let i=l[e];console.log("Error: "+i),K(i),$(!0)}}}else K(e.message),$(!0)}}).catch(e=>{K(D.xR.ADD_ERROR_MESSAGE),$(!0)})},validationSchema:q,children:i=>{var l,n;let{values:s,errors:d,touched:u,setFieldValue:c}=i;return(0,t.jsx)(f.l0,{encType:"multipart/form-data",children:(0,t.jsxs)(p.ZP,{container:!0,rowSpacing:1,columnSpacing:{xs:1,sm:2,md:3},sx:{marginTop:"2rem"},children:[(0,t.jsxs)(p.ZP,{item:!0,xs:6,children:[(0,t.jsx)("label",{style:{fontSize:"16px",fontFamily:"-apple-system"},children:D.xR.PHOTO}),(0,t.jsx)("div",{children:(0,t.jsx)(U.Z,{beforeUpload:()=>!1,onChange:e=>Q(e,c),accept:"image/*",listType:"picture-card",maxCount:1,children:(0,t.jsx)(N(),{style:{backgroundColor:"#089B1A",color:"white",border:"none",borderRadius:"5px"},children:"Pick File"})})})]}),(0,t.jsx)(p.ZP,{item:!0,xs:6,children:G&&(0,t.jsx)("img",{src:G,alt:"Preview",style:{width:"70px",height:"70px",marginTop:"10px"}})}),(0,t.jsx)(p.ZP,{item:!0,xs:6,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{fontSize:"16px",fontFamily:"-apple-system"},children:[D.xR.NAME," ",(0,t.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,t.jsx)(f.gN,{size:"small",variant:"outlined",sx:{mb:2,"& input":{color:"#4F4D4D"}},name:"name",as:m.Z,type:"text",fullWidth:!0}),u.name&&d.name&&(0,t.jsx)("div",{style:{color:"red",fontSize:"12px",marginTop:"-20px",marginLeft:"15px"},children:d.name})]})}),(0,t.jsx)(p.ZP,{item:!0,xs:6,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{fontSize:"16px",fontFamily:"-apple-system"},children:[D.xR.EMAIL," ",(0,t.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,t.jsx)(f.gN,{size:"small",variant:"outlined",sx:{mb:2,"& input":{color:"#4F4D4D"}},name:"email",as:m.Z,type:"email",fullWidth:!0}),u.email&&d.email&&(0,t.jsx)("div",{style:{color:"red",fontSize:"12px",marginTop:"-20px",marginLeft:"15px"},children:d.email})]})}),(0,t.jsx)(p.ZP,{item:!0,xs:6,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{fontSize:"16px",fontFamily:"-apple-system"},children:[D.xR.PHONE," ",(0,t.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,t.jsx)(f.gN,{size:"small",variant:"outlined",sx:{mb:2,"& input":{color:"#4F4D4D"}},name:"mobile",as:m.Z,type:"text",fullWidth:!0}),u.mobile&&d.mobile&&(0,t.jsx)("div",{style:{color:"red",fontSize:"12px",marginTop:"-20px",marginLeft:"15px"},children:d.mobile})]})}),(0,t.jsxs)(p.ZP,{item:!0,xs:6,children:[(0,t.jsxs)("label",{style:{fontSize:"16px",fontFamily:"-apple-system"},children:[D.xR.STATUS,(0,t.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,t.jsx)(f.gN,{name:"status",as:v.Z,children:e=>{let{field:i,form:l}=e;return(0,t.jsx)(v.Z,{...i,value:er,onChange:(e,i)=>{es(i),l.setFieldValue("status",i?Number(i.value):null)},options:et,getOptionLabel:e=>e.label,renderInput:e=>(0,t.jsx)(m.Z,{...e,size:"small",variant:"outlined",error:l.errors.status&&l.touched.status,helperText:l.errors.status&&l.touched.status&&l.errors.status,sx:{mb:2,"& input":{color:"#4F4D4D"}}})})}})]}),(null==e?void 0:null===(l=e.userProfile)||void 0===l?void 0:l.user_type)==0&&(0,t.jsx)(p.ZP,{item:!0,xs:6,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{fontSize:"16px",fontFamily:"-apple-system"},children:["User Type",(0,t.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,t.jsx)(f.gN,{name:"use_type",as:v.Z,children:e=>{let{field:i,form:l}=e;return(0,t.jsx)(v.Z,{...i,value:r,onChange:(e,i)=>{o(i),l.setFieldValue("user_type",i?Number(i.id):null)},options:ei,getOptionLabel:e=>e.name,renderInput:e=>(0,t.jsx)(m.Z,{...e,size:"small",variant:"outlined",error:l.errors.type&&l.touched.user_type,helperText:l.errors.type&&l.touched.user_type&&l.errors.user_type,sx:{mb:2,"& input":{color:"#4F4D4D"}}})})}})]})}),(null==e?void 0:null===(n=e.userProfile)||void 0===n?void 0:n.user_type)==0&&3==r.id&&(0,t.jsx)(p.ZP,{item:!0,xs:6,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{fontSize:"16px",fontFamily:"-apple-system"},children:["Organization",(0,t.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,t.jsx)(f.gN,{name:"organization_id",as:v.Z,children:e=>{let{field:i,form:l}=e;return(0,t.jsx)(v.Z,{...i,value:y,onChange:(e,i)=>{Z(i),l.setFieldValue("organization_id",i?Number(i.id):null)},options:b,getOptionLabel:e=>e.name,renderInput:e=>(0,t.jsx)(m.Z,{...e,size:"small",variant:"outlined",error:l.errors.organization_id&&l.touched.organization_id,helperText:l.errors.organization_id&&l.touched.organization_id&&l.errors.organization_id,sx:{mb:2,"& input":{color:"#4F4D4D"}}})})}})]})}),(0,t.jsxs)(p.ZP,{container:!0,direction:"row",children:[(0,t.jsx)(p.ZP,{item:!0,xs:6,children:(0,t.jsx)("div",{style:{width:"100%"},children:(0,t.jsx)(a(),{href:A.GN.USER_REQUEST,children:(0,t.jsx)(j.Z,{variant:"contained",sx:{background:"white",padding:"3px",color:"#4287DA",mb:2,float:"","&:hover":{background:"#10741C",color:"white"}},children:D.Fo})})})}),(0,t.jsx)(p.ZP,{item:!0,xs:6,children:(0,t.jsxs)("div",{style:{width:"100%"},children:[(0,t.jsx)(j.Z,{type:"submit",color:"primary",loading:M,variant:"contained",sx:{background:"#089B1A",padding:"3px",color:"white",mb:2,float:"right","&:hover":{background:"#10741C"}},children:D.zD}),(0,t.jsx)(P.Z,{open:V,onClose:Y,message:J}),(0,t.jsx)(T.Z,{open:X,onClose:Y,message:J})]})})]})]})})}})})})})})})})]}):(0,t.jsx)(F.Z,{})]})};O.getLayout=e=>(0,t.jsx)(b.A,{children:e}),i.default=(0,E.$j)(e=>{var i,l;return{isAuthenticated:null===(i=(0,S.Z)(e))||void 0===i?void 0:i.isAuthenticated,userProfile:null===(l=(0,R.Z)(e))||void 0===l?void 0:l.userProfile}},e=>({setUserProfileToReducerProp:i=>e((0,_.c9)(i))}))(O)}},function(e){e.O(0,[8199,9817,6901,7539,5968,1664,1159,9845,6886,8360,3029,8482,135,5551,3978,4110,8939,9620,9424,9774,2888,179],function(){return e(e.s=9698)}),_N_E=e.O()}]);